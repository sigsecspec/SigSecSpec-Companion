<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phonetic Alphabet — Security Companion</title>
<link rel="stylesheet" href="app-styles.css">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f0f0f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <script src="push-notifications.js"></script>
  <script src="emergency-common.js"></script>
  <script src="popup-system.js"></script>
  <script src="page-transitions.js"></script>
</head>
<body class="bg-pattern">

<!-- Header -->
<header class="app-header">
  <div class="flex items-center gap-3">
    <div class="app-logo">
      <img src="patch-bg.png" alt="Security Logo">
    </div>
    <div class="header-content">
      <h1>Phonetic Alphabet</h1>
      <p>NATO standard</p>
    </div>
  </div>
  <div class="header-actions">
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme"></button>
  </div>
</header>

<!-- Emergency Button - Bottom Right -->
<button class="emergency-btn-fixed" onclick="triggerEmergency()" aria-label="Emergency alert">
  🚨
</button>

<main class="main-content">
  <section>
    <h2 class="text-xl font-bold accent mb-4">Phonetic Alphabet (NATO)</h2>
    <div class="flex flex-col md:flex-row md:items-center gap-3 mb-4">
      <input id="radioSearch" class="form-input md:max-w-lg" placeholder="Search letter or word (e.g., 'Juliet', 'X-ray')" />
      <div class="flex items-center gap-2 md:ml-auto">
        <button id="radioClear" class="touch-btn">Clear</button>
        <span id="radioCount" class="text-sm" style="color: var(--text-secondary)"></span>
      </div>
    </div>
    <div id="radioGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 mb-2"></div>
    <p id="radioNoResults" class="hidden mt-6 text-center" style="color: var(--text-muted)">No matching letters or words.</p>
    <div id="radioStatus" class="text-sm mt-2" style="color: var(--text-secondary)" aria-live="polite"></div>

    <div class="mobile-card mt-6">
      <div class="font-semibold mb-1">📻 Radio Best Practices</div>
      <ul class="list-disc list-inside text-sm space-y-1" style="color: var(--text-secondary)">
        <li>Think before transmitting; keep it brief and clear.</li>
        <li>Use 10-codes and phonetics to reduce confusion.</li>
        <li>Wait for a clear channel; avoid stepping on traffic.</li>
      </ul>
    </div>
  </section>
</main>

<!-- Bottom Navigation -->
<nav class="bottom-nav">
  <div class="nav-grid">
    <a href="index.html" class="nav-item">
      <div class="nav-icon">🏠</div>
      <span>Home</span>
    </a>
    <a href="schedule.html" class="nav-item">
      <div class="nav-icon">📋</div>
      <span>Schedule</span>
    </a>
    <a href="reports.html" class="nav-item">
      <div class="nav-icon">📝</div>
      <span>Reports</span>
    </a>
    <a href="patrol.html" class="nav-item">
      <div class="nav-icon">🚶</div>
      <span>Patrol</span>
    </a>
    <a href="profile.html" class="nav-item">
      <div class="nav-icon">👤</div>
      <span>Profile</span>
    </a>
  </div>
</nav>

<script>
// Theme management
function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
}

function initTheme() {
  const savedTheme = localStorage.getItem('theme') || 'dark';
  document.documentElement.setAttribute('data-theme', savedTheme);
}


document.addEventListener('DOMContentLoaded',()=>{
  initTheme();
});

// Phonetic Alphabet data and search/copy logic
const PHONETIC = [
  { letter:'A', word:'Alpha',   synonyms:['alfa','alpha'] },
  { letter:'B', word:'Bravo',   synonyms:[] },
  { letter:'C', word:'Charlie', synonyms:[] },
  { letter:'D', word:'Delta',   synonyms:[] },
  { letter:'E', word:'Echo',    synonyms:[] },
  { letter:'F', word:'Foxtrot', synonyms:[] },
  { letter:'G', word:'Golf',    synonyms:[] },
  { letter:'H', word:'Hotel',   synonyms:[] },
  { letter:'I', word:'India',   synonyms:[] },
  { letter:'J', word:'Juliett', synonyms:['juliet'] },
  { letter:'K', word:'Kilo',    synonyms:[] },
  { letter:'L', word:'Lima',    synonyms:[] },
  { letter:'M', word:'Mike',    synonyms:[] },
  { letter:'N', word:'November',synonyms:[] },
  { letter:'O', word:'Oscar',   synonyms:[] },
  { letter:'P', word:'Papa',    synonyms:[] },
  { letter:'Q', word:'Quebec',  synonyms:[] },
  { letter:'R', word:'Romeo',   synonyms:[] },
  { letter:'S', word:'Sierra',  synonyms:[] },
  { letter:'T', word:'Tango',   synonyms:[] },
  { letter:'U', word:'Uniform', synonyms:[] },
  { letter:'V', word:'Victor',  synonyms:[] },
  { letter:'W', word:'Whiskey', synonyms:['whisky'] },
  { letter:'X', word:'X-ray',   synonyms:['xray','x ray','x-ray'] },
  { letter:'Y', word:'Yankee',  synonyms:[] },
  { letter:'Z', word:'Zulu',    synonyms:[] }
];

let lastRendered = [];
const radioGrid = document.getElementById('radioGrid');
const radioSearch = document.getElementById('radioSearch');
const radioClear = document.getElementById('radioClear');
const radioCount = document.getElementById('radioCount');
const radioNoResults = document.getElementById('radioNoResults');
const radioStatus = document.getElementById('radioStatus');

const normalize = (s)=> (s||'').toLowerCase();
const simplify = (s)=> normalize(s).replace(/[^a-z0-9]/g,'');

function matches(item, query){
  if(!query) return true;
  const tokens = query.split(/\s+/).filter(Boolean).map(simplify);
  const hay = [ item.letter, item.word, ...(item.synonyms||[]) ]
    .map(simplify).join(' ');
  return tokens.every(t=> hay.includes(t));
}

function renderList(query){
  const list = PHONETIC.filter(it=> matches(it, query));
  lastRendered = list;
  radioCount.textContent = list.length ? `${list.length} item${list.length!==1?'s':''}` : '';
  radioNoResults.classList.toggle('hidden', list.length!==0);
  radioGrid.innerHTML = list.map((it,idx)=>`
    <button class="mobile-card interactive text-left" data-index="${idx}" title="Tap to copy">
      <div class="font-semibold">${it.letter} — ${it.word}</div>
    </button>
  `).join('');
}

async function copyText(text){
  try{
    await navigator.clipboard.writeText(text);
    radioStatus.textContent = 'Copied to clipboard.';
  }catch{
    try{
      const ta = document.createElement('textarea');
      ta.value = text; document.body.appendChild(ta); ta.select();
      document.execCommand('copy'); document.body.removeChild(ta);
      radioStatus.textContent = 'Copied to clipboard.';
    }catch{
      radioStatus.textContent = 'Copy failed. Long-press to copy.';
    }
  }
}

radioGrid.addEventListener('click',(e)=>{
  const btn = e.target.closest('[data-index]');
  if(!btn) return;
  const idx = Number(btn.getAttribute('data-index'));
  const item = lastRendered[idx];
  if(!item) return;
  copyText(`${item.letter} — ${item.word}`);
});

function applySearch(value){
  localStorage.setItem('sss_radio_query', value);
  renderList(normalize(value));
}

const saved = localStorage.getItem('sss_radio_query') || '';
radioSearch.value = saved;
applySearch(saved);

let debounceTimer;
radioSearch.addEventListener('input',()=>{
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(()=> applySearch(radioSearch.value), 120);
});
radioClear.addEventListener('click',()=>{ radioSearch.value=''; applySearch(''); });
</script>
</body>
</html>